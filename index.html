<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>Trivia Game</title>
    <!-- Bootstrap File -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <!-- My own CSS File-->
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery.js"></script>
</head>


<body>

    <div class="jumbotron jumbotron-fluid text-center">
        <h1>Trivia Game</h1>
        <h2 id="timer"> </h2>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <button type="button" class="btn btn-light btn-block" onclick="start();" id="startButton">Game Start</button>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">
                <div id="questionDisplay"></div>
            </div>
        </div>
    </div>


    <!-- Script -->
    <script type="text/javascript">

        // Each multiple choice question is stored as a object in the array 'questions', with all the possible choices as 'options'
        // Answer to each question is stored in the 'answer' property, gif image url is in 'gif'
        var multipleChoiceQuiz = [
            {
                question: "What is i++ equivalent to?",
                options: ["i = i + 1", "i = i - 1", "i = i + i", "i = 1 + 1"],
                answer: "i = i + 1",
                gif: "https://media.giphy.com/media/26BGIqWh2R1fi6JDa/giphy.gif"
            },
            {
                question: "What is the range for the random number that Math.random() generates?",
                options: ["between 0 and 1, including 1", "between -1 and 1", "between 0 and 10", "between 0 and 1, not including 1"],
                answer: "between 0 and 1, not including 1",
                gif: "https://media.giphy.com/media/vzO0Vc8b2VBLi/giphy.gif"
            },
            {
                question: "What game theme did Quincy say would earn extra points for this assignment?",
                options: ["Pokeman", "Chinpokomon", "Pokemon", "Pokebowl"],
                answer: "Pokemon",
                gif: "https://media.giphy.com/media/3ov9jNziFTMfzSumAw/giphy.gif"
            },
            {
                question: "What is jQuery?",
                options: ["JavaScript library", "JavaScript convention", "JavaScript parameter", "Javascript friendo"],
                answer: "JavaScript library",
                gif: "https://media.giphy.com/media/349qKnoIBHK1i/giphy.gif"
            },
            {
                question: "Which is a correct example of camel casing?",
                options: ["IDONOTKNOWWHATTODO", "Idonotknowwhattodo", "iDoNotKnowWhatToDo", "IDoNotKnowWhatToDo"],
                answer: "iDoNotKnowWhatToDo",
                gif: "https://media.giphy.com/media/YQitE4YNQNahy/giphy.gif"
            }

        ];

        // variables for correct, wrong and unanswered question count
        var numCorrect = 0;
        var numWrong = 0;
        var numUnanswered = 0;
        var number = 36  // 36 seconds = 30 seconds displaying question + 5 seconds displaying gif
        var intervalId;
        var clockRunning = false; // slows down so not all questions at once
        var i = 0; //first question

        // Function for when the start button is pressed 
        function start() {
            $("#startButton").hide(); // Hide the start button
            if (!clockRunning) {
                intervalId = setInterval(countdown, 1000); // run countdown function every second
            }
            newQuestion(); // loads the first question
        }

        // function for counting down seconds during the question and answer display
        function countdown() {
            number--;
            if (number > 5) { // 5 second is alloted time of the gif
                // what is actually displayed to the user is the time alloted minus 5 seconds
                $('#timer').text((number - 5) + " seconds remaining");

                // event listener for an option getting clicked
                $("button").unbind().click(function () {
                    number = 5; // immediately change counter to 5 seconds (move to gif image)
                    var chosen = $(this).attr('value');
                    if (chosen === multipleChoiceQuiz[i].answer) { // correct answer 
                        numCorrect++;
                        playGif();
                        $("#questionDisplay").prepend("<p> Correct! </p>");
                    } else if (chosen !== multipleChoiceQuiz[i].answer) { // wrong answer
                        numWrong++;
                        playGif();
                        $("#questionDisplay").prepend("<p> The correct answer was " + multipleChoiceQuiz[i].answer + "</p>");
                    }
                });
            } else if (number === 5) { // time ran out, display gif
                $('#timer').html("");
                numUnanswered++; // you reached the time limit so the question was unanswered
                playGif();
            } else if (number === 0) { // next question
                reset();
            }
        }

        function reset() {
            number = 36;
            clockRunning = true;
            $("#questionDisplay").html("");
            i++;
            newQuestion();
        }

        function playGif() {
            $("#questionDisplay").html("");
            $("#timer").html("");
            var image = $("<img>");
            image.attr("src", multipleChoiceQuiz[i].gif);
            $("#questionDisplay").append(image);
        }

        function endGame() {
            $("#questionDisplay").html("");
            clearInterval(intervalId);
            $("#timer").hide();
            $("#questionDisplay").append("<p>Correct Answers: " + numCorrect + "</p>");
            $("#questionDisplay").append("<p>Incorrect Answers: " + numWrong + "</p>");
            $("#questionDisplay").append("<p>Unanswered: " + numUnanswered + "</p>");
            var restartGameButton = $("<button>");
            restartGameButton.text("Restart Game");
            restartGameButton.attr(onclick, "newGame();");
            $("#questionDisplay").append(restartGameButton);
        }

        function newGame() {
            numCorrect = 0;
            numWrong = 0;
            numUnanswered = 0;
            i = 0;
        }

        // Formats each question object in the multiple choice quiz array for displaying
        function newQuestion() {

            // Conditional when ending the game
            if (numCorrect + numWrong + numUnanswered === multipleChoiceQuiz.length) {
                endGame();
            } else {

                // Create a empty div 
                var questionDiv = $("<div>");

                // Appending the question
                questionDiv.append(multipleChoiceQuiz[i].question + "<br>");

                // taking out the array of options from the object and storing as variable optionArray
                var optionArray = multipleChoiceQuiz[i].options;

                // Generating buttons for each of the options
                for (var j = 0; j < optionArray.length; j++) {
                    var button = document.createElement("button");
                    button.value = optionArray[j]; // Option is stored as a value attribute in button
                    button.innerHTML = optionArray[j]; // Option shows up as text on the button
                    questionDiv.append(button);
                    questionDiv.append("<br>"); // moves next button on new line
                }

                // add the question to the div
                $("#questionDisplay").append(questionDiv);
            } // close else

        } // close function newQuestion





    </script>

</body>

</html>